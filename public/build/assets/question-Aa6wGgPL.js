$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});document.addEventListener("DOMContentLoaded",function(){let i=!1,q=document.querySelectorAll(".question[data-question-id]").length,a=0,d=null;function h(){let e=a/q*100;document.querySelectorAll("[id^='progress-bar-']").forEach(t=>{t.style.width=e+"%"})}function f(){a=0,d=null,document.querySelectorAll(".question[data-question-id]").forEach(e=>{let t=!1,n=parseInt(e.getAttribute("data-question-index")),r=e.querySelector("input[name^='answers']:checked"),o=e.querySelector("input[name^='answers_future']:checked");(r||o)&&(t=!0),e.querySelector("input[type='checkbox']:checked")&&(t=!0),e.querySelector("input[type='text']:not(:placeholder-shown)")&&(t=!0),e.querySelector("input[type='date']:not(:placeholder-shown)")&&(t=!0),e.querySelector("textarea:not(:placeholder-shown)")&&(t=!0),t&&(a++,d=n)}),h(),console.log("Current Question Index: "+d)}document.querySelectorAll(".question input, .question textarea").forEach(e=>{e.addEventListener("input",f)}),document.querySelectorAll(".question input[type='radio'], .question input[type='checkbox']").forEach(e=>{e.addEventListener("change",f)}),f();function p(e){console.log(`Starting Quiz for Section ID: ${e}`);const t=document.getElementById(`section-card-${e}`),n=document.getElementById(`question-card-${e}`);t?t.style.display="none":console.error(`Section card not found for Section ID: ${e}`),n?(n.style.display="block",u(e,"next")):console.error(`Question card not found for Section ID: ${e}`)}function g(e){if(i){console.log("Transition already in progress, skipping...");return}console.log(`showNextSection called for Section ID: ${e}`),i=!0;const t=Array.from(document.querySelectorAll('.card[id^="section-card-"]'));let n=t.findIndex(r=>r.id===`section-card-${e}`);if(n===-1){console.error(`Section with ID ${e} not found!`),i=!1;return}if(console.log(`Hiding current section (ID: ${e})`),t[n].style.display="none",n+1<t.length){const r=t[n+1];console.log(`Displaying next section (ID: ${r.id})`);const o=r.id.split("-").pop();console.log(`Next Section ID: ${o}`),r.style.display="block";const l=document.getElementById(`start-quiz-btn-${o}`);l&&(l.style.display="block",l.onclick=function(){p(o)}),i=!1}else console.log("No more sections. Quiz completed!"),x(),i=!1}function u(e,t){const n=document.querySelector(`#questions-container-${e}`),r=document.querySelector(`#question-card-${e}`);if(document.querySelector(`#current-question-number-${e}`),!n||!r){console.error(`Missing elements for Section ID: ${e}`);return}const o=n.querySelectorAll(".question");if(o.length===0){console.error(`No questions found for Section ID: ${e}`);return}let l;t==="last"?l=o.length-1:(l=Array.from(o).findIndex(c=>c.style.display==="block"),l===-1?l=0:t==="next"&&l<o.length-1?l++:t==="prev"&&l>0&&l--),o.forEach(c=>c.style.display="none"),l>=0&&(o[l].style.display="block"),document.querySelectorAll('.card[id^="question-card-"]').forEach(c=>{c.style.display="none"});let s=Array.from(document.querySelectorAll(".question[data-question-id]")),y=s.indexOf(o[l])+1;document.querySelectorAll("[id^='question-progress']").forEach(c=>{c.textContent=`Question ${y} out of ${s.length}`}),console.log(`Current Question Index: ${y} / ${s.length}`),r.style.display="block",S(e,l,o.length)}function S(e,t,n){const r=document.getElementById(`prev-btn${e}`),o=document.getElementById(`next-btn${e}`);r.style.display=t===0?"none":"inline-block",t===n-1?(o.textContent="Next",o.onclick=function(){m(e)}):(o.textContent="Next",o.onclick=function(){u(e,"next")}),r.textContent="Prev",r.onclick=function(){if(t===0){const l=Array.from(document.querySelectorAll('.card[id^="question-card-"]')).findIndex(s=>s.id===`question-card-${e}`)-1;if(l>=0){const s=document.querySelectorAll('.card[id^="question-card-"]')[l].id.split("-").pop();document.querySelector(`#questions-container-${s}`).querySelectorAll(".question").length-1,u(s,"last")}}else u(e,"prev")}}function m(e){console.log(`Finishing Section ID: ${e}`);const t=document.getElementById(`section-card-${e}`),n=document.getElementById(`question-card-${e}`);n.style.display="none",t.style.display="block",g(e)}function x(){const e=document.getElementById("completion-card");e&&(console.log("Displaying completion card..."),e.style.display="block")}document.querySelectorAll('input[type="date"]').forEach(e=>{e.addEventListener("change",function(){const t=this.value;console.log(`Date selected for Question: ${this.name} - ${t}`)})}),document.querySelectorAll(".rating .star").forEach(e=>{e.addEventListener("click",function(){const t=this.closest(".rating").dataset.questionId,n=this.dataset.index;document.querySelector(`#selectedRating_${t}`).value=n,w(t,n)})});function E(e,t){document.querySelectorAll(`#rating_${e} .star`).forEach((r,o)=>{o<t?r.style.color="gold":r.style.color="#ccc"})}function A(e){const t=document.querySelectorAll(`#rating_${e} .star`),n=parseInt(document.querySelector(`#selectedRating_${e}`).value);t.forEach((r,o)=>{o<n?r.style.color="gold":r.style.color="#ccc"})}function w(e,t){document.querySelectorAll(`#rating_${e} .star`).forEach((r,o)=>{r.style.color=o<t?"gold":"#ccc"})}document.querySelectorAll(".star").forEach(e=>{const t=e.parentElement.id.split("_")[1];e.addEventListener("mouseover",function(){const n=parseInt(e.getAttribute("data-index"));E(t,n)}),e.addEventListener("mouseout",function(){A(t)})}),window.startQuiz=p,window.showQuestion=u,window.finishSection=m,window.showNextSection=g});
