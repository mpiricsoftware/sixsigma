$.ajaxSetup({headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")}});document.addEventListener("DOMContentLoaded",function(){let l=!1;function a(e){console.log(`Starting Quiz for Section ID: ${e}`);const t=document.getElementById(`section-card-${e}`),o=document.getElementById(`question-card-${e}`);t?t.style.display="none":console.error(`Section card not found for Section ID: ${e}`),o?(o.style.display="block",r(e,"next")):console.error(`Question card not found for Section ID: ${e}`)}function u(e){if(l){console.log("Transition already in progress, skipping...");return}console.log(`showNextSection called for Section ID: ${e}`),l=!0;const t=Array.from(document.querySelectorAll('.card[id^="section-card-"]'));let o=t.findIndex(s=>s.id===`section-card-${e}`);if(o===-1){console.error(`Section with ID ${e} not found!`),l=!1;return}if(console.log(`Hiding current section (ID: ${e})`),t[o].style.display="none",o+1<t.length){const s=t[o+1];console.log(`Displaying next section (ID: ${s.id})`);const n=s.id.split("-").pop();console.log(`Next Section ID: ${n}`),s.style.display="block";const c=document.getElementById(`start-quiz-btn-${n}`);c&&(c.style.display="block",c.onclick=function(){a(n)}),l=!1}else console.log("No more sections. Quiz completed!"),y(),l=!1}function r(e,t){const o=document.querySelector(`#questions-container-${e}`),s=document.querySelector(`#question-card-${e}`);if(!o||!s){console.error(`Questions container or Section Card not found for Section ID: ${e}`);return}const n=o.querySelectorAll(".question");if(console.log(`Found questions for Section ID ${e}:`,n),n.length===0){console.error(`No questions found for Section ID: ${e}`);return}let c;t==="last"?c=n.length-1:(c=Array.from(n).findIndex(i=>i.style.display==="block"),c===-1?c=0:t==="next"&&c<n.length-1?c++:t==="prev"&&c>0&&c--),n.forEach(i=>i.style.display="none"),c>=0&&(n[c].style.display="block"),document.querySelectorAll('.card[id^="question-card-"]').forEach(i=>{i.style.display="none"}),s.style.display="block",f(e,c,n.length)}function f(e,t,o){const s=document.getElementById(`prev-btn${e}`),n=document.getElementById(`next-btn${e}`);s.style.display=t===0?"none":"inline-block",t===o-1?(n.textContent="Next",n.onclick=function(){d(e)}):(n.textContent="Next",n.onclick=function(){r(e,"next")}),s.textContent="Prev",s.onclick=function(){if(t===0){const c=Array.from(document.querySelectorAll('.card[id^="question-card-"]')).findIndex(i=>i.id===`question-card-${e}`)-1;if(c>=0){const i=document.querySelectorAll('.card[id^="question-card-"]')[c].id.split("-").pop();document.querySelector(`#questions-container-${i}`).querySelectorAll(".question").length-1,r(i,"last")}}else r(e,"prev")}}function d(e){console.log(`Finishing Section ID: ${e}`);const t=document.getElementById(`section-card-${e}`),o=document.getElementById(`question-card-${e}`);o.style.display="none",t.style.display="block",u(e)}function y(){const e=document.getElementById("completion-card");e&&(console.log("Displaying completion card..."),e.style.display="block")}document.querySelectorAll('input[type="date"]').forEach(e=>{e.addEventListener("change",function(){const t=this.value;console.log(`Date selected for Question: ${this.name} - ${t}`)})}),document.querySelectorAll(".rating .star").forEach(e=>{e.addEventListener("click",function(){const t=this.closest(".rating").dataset.questionId,o=this.dataset.index;document.querySelector(`#selectedRating_${t}`).value=o,p(t,o)})});function g(e,t){document.querySelectorAll(`#rating_${e} .star`).forEach((s,n)=>{n<t?s.style.color="gold":s.style.color="#ccc"})}function m(e){const t=document.querySelectorAll(`#rating_${e} .star`),o=parseInt(document.querySelector(`#selectedRating_${e}`).value);t.forEach((s,n)=>{n<o?s.style.color="gold":s.style.color="#ccc"})}function p(e,t){document.querySelectorAll(`#rating_${e} .star`).forEach((s,n)=>{s.style.color=n<t?"gold":"#ccc"})}document.querySelectorAll(".star").forEach(e=>{const t=e.parentElement.id.split("_")[1];e.addEventListener("mouseover",function(){const o=parseInt(e.getAttribute("data-index"));g(t,o)}),e.addEventListener("mouseout",function(){m(t)})}),window.startQuiz=a,window.showQuestion=r,window.finishSection=d,window.showNextSection=u});
